<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>{{ event.event_name }} | SchoolOps</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #0f172a; min-height: 100vh; color: white; }
        .container { max-width: 600px; margin: 0 auto; padding: 0 16px 40px; }
        .nav-header { display: flex; justify-content: space-between; align-items: center; padding: 16px 0; margin-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .nav-back { color: #60a5fa; text-decoration: none; font-size: 14px; font-weight: 500; padding: 8px 12px; border-radius: 8px; }
        .nav-title { font-size: 18px; font-weight: 600; color: white; }
        .nav-home { font-size: 20px; text-decoration: none; padding: 8px 12px; border-radius: 8px; }
        .event-header { background: linear-gradient(135deg, #1e3a5f 0%, #1e293b 100%); border-radius: 16px; padding: 24px; margin: 20px 0; }
        .event-sport-badge { display: inline-block; background: rgba(255,255,255,0.15); padding: 6px 14px; border-radius: 20px; font-size: 13px; margin-bottom: 12px; }
        .event-title { font-size: 24px; font-weight: 700; margin-bottom: 16px; }
        .event-meta { display: flex; flex-direction: column; gap: 12px; }
        .meta-item { display: flex; align-items: center; gap: 12px; }
        .meta-icon { width: 36px; height: 36px; background: rgba(255,255,255,0.1); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .meta-content { flex: 1; }
        .meta-label { font-size: 11px; color: rgba(255,255,255,0.5); text-transform: uppercase; }
        .meta-value { font-size: 15px; font-weight: 500; margin-top: 2px; }
        .location-home { color: #22c55e; }
        .location-away { color: #f97316; }
        .status-badge { display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 500; margin-top: 16px; }
        .status-scheduled { background: rgba(59, 130, 246, 0.2); color: #60a5fa; }
        .status-completed { background: rgba(34, 197, 94, 0.2); color: #4ade80; }
        .status-cancelled { background: rgba(239, 68, 68, 0.2); color: #f87171; }
        .section-title { font-size: 14px; font-weight: 600; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 0.5px; margin: 24px 0 12px; padding-left: 4px; }
        .duty-group { background: #1e293b; border-radius: 12px; margin-bottom: 12px; overflow: hidden; }
        .duty-header { padding: 12px 16px; background: rgba(255,255,255,0.05); font-size: 14px; font-weight: 600; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .duty-list { padding: 8px 0; }
        .duty-item { display: flex; align-items: center; gap: 12px; padding: 10px 16px; }
        .duty-avatar { width: 32px; height: 32px; background: linear-gradient(135deg, #3b82f6, #6366f1); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 600; }
        .duty-name { font-size: 14px; flex: 1; }
        .duty-role { font-size: 12px; color: rgba(255,255,255,0.5); }
        .no-duties { text-align: center; padding: 40px 20px; color: rgba(255,255,255,0.4); }
        .no-duties-icon { font-size: 32px; margin-bottom: 12px; }
        .no-duties-text { font-size: 14px; }
        .affects-notice { background: rgba(124, 58, 237, 0.2); border: 1px solid rgba(124, 58, 237, 0.3); border-radius: 12px; padding: 16px; margin-top: 16px; display: flex; align-items: flex-start; gap: 12px; }
        .affects-notice-icon { font-size: 20px; }
        .affects-notice-text { font-size: 13px; color: rgba(255,255,255,0.8); line-height: 1.5; }
        {{ nav_styles }}
    </style>
</head>
<body>
    <div class="container">
        {{ nav_header|safe }}
        <div class="event-header">
            <div class="event-sport-badge">{{ event.sport_type }}</div>
            <h1 class="event-title">{{ event.event_name }}</h1>
            <div class="event-meta">
                <div class="meta-item">
                    <div class="meta-icon">üìÖ</div>
                    <div class="meta-content">
                        <div class="meta-label">Date</div>
                        <div class="meta-value">{{ event.day_name }}, {{ event.date_display }}</div>
                    </div>
                </div>
                <div class="meta-item">
                    <div class="meta-icon">üïê</div>
                    <div class="meta-content">
                        <div class="meta-label">Time</div>
                        <div class="meta-value">{{ event.time_display }}</div>
                    </div>
                </div>
                <div class="meta-item">
                    <div class="meta-icon">üìç</div>
                    <div class="meta-content">
                        <div class="meta-label">Venue</div>
                        <div class="meta-value {{ 'location-home' if event.location_type == 'Home' else 'location-away' }}">
                            {{ event.venue_name or event.location_type }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="status-badge status-{{ event.status|lower }}">
                {% if event.status == 'Scheduled' %}üìã{% elif event.status == 'Completed' %}‚úÖ{% else %}‚ùå{% endif %}
                {{ event.status }}
            </div>
            {% if event.affects_timetable %}
            <div class="affects-notice">
                <div class="affects-notice-icon">‚ö†Ô∏è</div>
                <div class="affects-notice-text">This event affects the normal timetable. Check with your Grade Head for schedule changes.</div>
            </div>
            {% endif %}
        </div>
        <div class="section-title">Duty Assignments</div>
        {% if duties %}
            {% for duty_group in duties %}
            <div class="duty-group">
                <div class="duty-header">{{ duty_group.type }}</div>
                <div class="duty-list">
                    {% for staff in duty_group.staff %}
                    <div class="duty-item">
                        <div class="duty-avatar">{{ staff.first_name[0] if staff.first_name else '?' }}</div>
                        <div class="duty-name">{{ staff.display_name }}</div>
                        {% if staff.duty_role %}
                        <div class="duty-role">{{ staff.duty_role }}</div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="no-duties">
                <div class="no-duties-icon">üë•</div>
                <div class="no-duties-text">No duty assignments yet</div>
            </div>
        {% endif %}
    </div>
</body>
</html>
